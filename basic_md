{
  "includeFiles":[
  ],
  "metadata":{
    "customPrefsImportMode":"reject",
    "dm":{
      "dms":[
        {
          "callbacks":{
            "entries":[
              {
                "amiscript":[
                  "{\n",
                  "  for(RealtimeEvent event=rtevents;event!=null;event=event.getNext()){\n",
                  "    //TODO: handle realtime event.\n",
                  "  }\n",
                  "}\n"
                ],
                "hasDatamodel":true,
                "linkedVariables":[
                ],
                "name":"onProcess",
                "schema":{
                  "tbl":[
                    {
                      "cols":[
                        {
                          "nm":"LastTradeTimestamp",
                          "tp":"Long"
                        },
                        {
                          "nm":"A",
                          "tp":"String"
                        },
                        {
                          "nm":"D",
                          "tp":"Long"
                        },
                        {
                          "nm":"Price",
                          "tp":"Double"
                        },
                        {
                          "nm":"Symbol",
                          "tp":"String"
                        },
                        {
                          "nm":"I",
                          "tp":"String"
                        }
                      ],
                      "nm":"FEED:simpleMD",
                      "oc":"ask"
                    }
                  ]
                }
              }
            ]
          },
          "lbl":"datamodel1",
          "queryMode":"startup",
          "subscribe":[
            "FEED:client_orders",
            "FEED:simpleMD"
          ],
          "test_input_type":"OPEN",
          "test_input_vars":"String WHERE=\"true\";"
        }
      ]
    },
    "fileVersion":4,
    "menubarPosition":"top",
    "rt":{
    },
    "stm":{
      "styles":[
        {
          "id":"LAYOUT_DEFAULT",
          "lb":"Layout Default",
          "pt":"DEFAULT"
        }
      ]
    },
    "transientIdPrefix":"TRANSIENT_"
  },
  "portletConfigs":[
    {
      "portletBuilderId":"amidesktop",
      "portletConfig":{
        "amiPanelId":"@DESKTOP",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "windows":[
          {
            "header":true,
            "heightDflt":323,
            "hidden":false,
            "leftDflt":40,
            "portlet":"Div7",
            "pos":0,
            "stateDflt":"flt",
            "title":"Window",
            "topDflt":60,
            "widthDflt":636,
            "zindexDflt":1
          }
        ]
      }
    },
    {
      "portletBuilderId":"div",
      "portletConfig":{
        "amiPanelId":"Div1",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "child1":"Div3",
        "child2":"Div2",
        "dir":"v",
        "locked":false,
        "offset":0.54166,
        "upid":"Div1"
      }
    },
    {
      "portletBuilderId":"div",
      "portletConfig":{
        "amiPanelId":"Div2",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "child1":"datamodel1",
        "child2":"PNL1",
        "dir":"h",
        "locked":false,
        "offset":0.68253,
        "upid":"Div2"
      }
    },
    {
      "portletBuilderId":"div",
      "portletConfig":{
        "amiPanelId":"Div3",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "child1":"Div4",
        "child2":"datamodel2",
        "dir":"h",
        "locked":false,
        "offset":0.31746,
        "upid":"Div3"
      }
    },
    {
      "portletBuilderId":"div",
      "portletConfig":{
        "amiPanelId":"Div4",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "child1":"Html2",
        "child2":"Tabs1",
        "dir":"h",
        "locked":false,
        "offset":0.66777,
        "upid":"Div4"
      }
    },
    {
      "portletBuilderId":"div",
      "portletConfig":{
        "amiPanelId":"Div5",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "child1":"PNL2",
        "child2":"PNL3",
        "dir":"v",
        "locked":false,
        "offset":0.70845,
        "upid":"Div5"
      }
    },
    {
      "portletBuilderId":"div",
      "portletConfig":{
        "amiPanelId":"Div7",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "child1":"Html4",
        "child2":"Div1",
        "dir":"h",
        "locked":false,
        "offset":0.15748,
        "upid":"Div7"
      }
    },
    {
      "portletBuilderId":"amiform",
      "portletConfig":{
        "amiPanelId":"Html2",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "fields":[
          {
            "callbacks":{
              "entries":[
                {
                  "amiscript":"USE ds=\"AMI\" EXECUTE DROP TABLE simpleMD;",
                  "linkedVariables":[
                  ],
                  "name":"onChange"
                }
              ]
            },
            "heightPx":20,
            "l":"Reset",
            "leftPosPx":20,
            "n":"button",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"buttonField",
            "topPosPx":0,
            "widthPx":200,
            "zidx":1
          },
          {
            "callbacks":{
              "entries":[
                {
                  "amiscript":[
                    "Table simpleMD = USE ds=\"AMI\" EXECUTE SELECT * FROM simpleMD;\n",
                    "Table closingPrices = \n",
                    "USE ds=\"AMI\" EXECUTE SELECT * FROM closingPrices;\n",
                    "\n",
                    "CREATE TABLE latestPrices AS\n",
                    "SELECT Symbol, Price\n",
                    "FROM simpleMD\n",
                    "GROUP BY Symbol\n",
                    "HAVING LastTradeTimestamp == MAX(LastTradeTimestamp);\n",
                    "\n",
                    "DELETE FROM closingPrices\n",
                    "WHERE Symbol IN (SELECT Symbol FROM latestPrices);\n",
                    "\n",
                    "INSERT INTO closingPrices (Symbol, Price)\n",
                    "SELECT Symbol, Price\n",
                    "FROM latestPrices;\n",
                    "\n",
                    "DROP TABLE latestPrices;"
                  ],
                  "linkedVariables":[
                  ],
                  "name":"onChange"
                }
              ]
            },
            "heightPx":20,
            "l":"End Trading Day",
            "leftPosPx":280,
            "n":"button1",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"buttonField",
            "topPosPx":0,
            "widthPx":200,
            "zidx":2
          },
          {
            "heightPx":20,
            "l":"test command ",
            "leftPosPx":96,
            "n":"button2",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"buttonField",
            "topPosPx":60,
            "widthPx":199,
            "zidx":3
          },
          {
            "callbacks":{
              "entries":[
                {
                  "amiscript":"USE ds=\"AMI\" EXECUTE CREATE PUBLIC TABLE client_orders(symbol String, type String, kind String, price double, qty integer timestamp double);",
                  "linkedVariables":[
                  ],
                  "name":"onChange"
                }
              ]
            },
            "heightPx":20,
            "l":"create client_orders",
            "leftPosPx":400,
            "n":"button3",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"buttonField",
            "topPosPx":40,
            "widthPx":200,
            "zidx":4
          }
        ],
        "snap":20,
        "upid":"Html2"
      }
    },
    {
      "portletBuilderId":"amiform",
      "portletConfig":{
        "amiPanelId":"Html3",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "fields":[
          {
            "callbacks":{
              "entries":[
                {
                  "amiscript":[
                    "double time = timestamp();\n",
                    "int quantity = 2;\n",
                    "double pricee = 150; // Due to frontend, price is a string (change later)\n",
                    "USE ds=\"AMI\" EXECUTE insert into client_orders values (\"${stock}\", \"${buysell}\", \"${marketlimit}\", \"${pricee}\", \"${quantity}\", \"${time}\");"
                  ],
                  "linkedVariables":[
                    {
                      "ari":"FIELDVALUE:Html3?select1?",
                      "varName":"buysell"
                    },
                    {
                      "ari":"FIELDVALUE:Html3?select2?",
                      "varName":"marketlimit"
                    },
                    {
                      "ari":"FIELDVALUE:Html3?text?",
                      "varName":"price"
                    },
                    {
                      "ari":"FIELDVALUE:Html3?slider?",
                      "varName":"qty"
                    },
                    {
                      "ari":"FIELDVALUE:Html3?select?",
                      "varName":"stock"
                    }
                  ],
                  "name":"onChange"
                }
              ]
            },
            "heightPx":20,
            "l":"Place Order",
            "leftPosPx":400,
            "n":"button",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"buttonField",
            "topPosPx":80,
            "widthPx":120,
            "zidx":2
          },
          {
            "dmid":"datamodel1",
            "dmtbid":"FEED:simpleMD",
            "dscid":"Symbol",
            "dsvid":"Symbol",
            "heightPx":20,
            "l":"Stock",
            "leftPosPx":60,
            "n":"select",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"selectField",
            "topPosPx":40,
            "widthPx":100,
            "zidx":1
          },
          {
            "heightPx":20,
            "l":"",
            "leftPosPx":280,
            "n":"select1",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"selectField",
            "topPosPx":80,
            "v":[
              {
                "k":"BUY",
                "v":"BUY"
              },
              {
                "k":"SELL",
                "v":"SELL"
              }
            ],
            "widthPx":120,
            "zidx":3
          },
          {
            "heightPx":20,
            "l":"",
            "leftPosPx":60,
            "n":"select2",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"selectField",
            "topPosPx":80,
            "v":[
              {
                "k":"LIMIT",
                "v":"LIMIT"
              },
              {
                "k":"MARKET",
                "v":"MARKET"
              }
            ],
            "widthPx":220,
            "zidx":4
          },
          {
            "heightPx":20,
            "l":"Quantity",
            "leftPosPx":220,
            "max":100.0,
            "min":0.0,
            "n":"slider",
            "s":5.0,
            "showSlider":true,
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"numericRange",
            "topPosPx":40,
            "widthPx":240,
            "zidx":5
          },
          {
            "heightPx":20,
            "l":"Price",
            "leftPosPx":500,
            "n":"text",
            "style":{
              "pt":"LAYOUT_DEFAULT"
            },
            "t":"textField",
            "topPosPx":40,
            "widthPx":120,
            "zidx":5
          }
        ],
        "htmlTemplate2":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>Place Order</title>\n\n</head>\n<body>\n  <header>Place Order</header>\n</body>\n</html>\n",
        "snap":20,
        "upid":"Html3"
      }
    },
    {
      "portletBuilderId":"amiform",
      "portletConfig":{
        "amiPanelId":"Html4",
        "amiStyle":{
          "bgCl":"#03590d",
          "pt":"LAYOUT_DEFAULT",
          "titlePnlFontCl":"#000000"
        },
        "snap":20,
        "upid":"Html4"
      }
    },
    {
      "portletBuilderId":"amirealtimetable",
      "portletConfig":{
        "amiCols":[
          {
            "fm":"LastTradeTimestamp",
            "id":"LastTradeTimestamp",
            "location":0,
            "tl":"Last Trade Timestamp",
            "tp":"datetime_sec",
            "width":140
          },
          {
            "fm":"Price",
            "id":"Price",
            "location":1,
            "tl":"Price",
            "tp":"price",
            "width":80
          },
          {
            "fm":"Symbol",
            "id":"Symbol",
            "location":2,
            "tl":"Symbol",
            "tp":"text",
            "width":100
          },
          {
            "fm":"orderType",
            "id":"orderType",
            "location":3,
            "tl":"order Type",
            "tp":"text",
            "width":100
          },
          {
            "id":"D",
            "width":100
          },
          {
            "id":"A",
            "width":100
          },
          {
            "id":"!data",
            "width":250
          },
          {
            "id":"M",
            "width":120
          },
          {
            "id":"C",
            "width":120
          },
          {
            "id":"V",
            "width":80
          },
          {
            "id":"W",
            "width":120
          },
          {
            "id":"T",
            "width":100
          },
          {
            "id":"P",
            "width":100
          },
          {
            "id":"E",
            "width":120
          },
          {
            "id":"I",
            "width":100
          }
        ],
        "amiPanelId":"PNL1",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "amiTitle":"simpleMD",
        "curtimeUpdateFrequency":1000,
        "editDblClk":true,
        "editMenuTitle":"Edit Row(s)",
        "editMode":0,
        "filters":{
        },
        "hah":"true",
        "pinCnt":0,
        "rollupEnabled":false,
        "rtDownstreamMode":"SELECTED_OR_ALL",
        "rtSources":[
          "FEED:simpleMD"
        ],
        "scrollToBottomOnAppend":false,
        "showCommandMenu":true,
        "titlePnl":{
          "title":"simpleMD"
        },
        "upid":"Table1",
        "varTypes":{
          "LastTradeTimestamp":"Long",
          "Price":"Double",
          "Symbol":"String",
          "orderType":"String"
        }
      }
    },
    {
      "portletBuilderId":"amirealtimetable",
      "portletConfig":{
        "amiCols":[
          {
            "fm":"Symbol",
            "id":"Symbol",
            "location":0,
            "tl":"Symbol",
            "tp":"text",
            "width":100
          },
          {
            "fm":"Price",
            "id":"Price",
            "location":1,
            "tl":"Price",
            "tp":"price",
            "width":80
          },
          {
            "id":"D",
            "width":100
          },
          {
            "id":"A",
            "width":100
          },
          {
            "id":"!data",
            "width":250
          },
          {
            "id":"M",
            "width":120
          },
          {
            "id":"C",
            "width":120
          },
          {
            "id":"V",
            "width":80
          },
          {
            "id":"W",
            "width":120
          },
          {
            "id":"T",
            "width":100
          },
          {
            "id":"P",
            "width":100
          },
          {
            "id":"E",
            "width":120
          },
          {
            "id":"I",
            "width":100
          }
        ],
        "amiPanelId":"PNL2",
        "amiStyle":{
          "bgCl":"#bbc9cc",
          "fontSz":22.0,
          "pt":"LAYOUT_DEFAULT"
        },
        "amiTitle":"orderLadderBuy",
        "curtimeUpdateFrequency":1000,
        "editDblClk":true,
        "editMenuTitle":"Edit Row(s)",
        "editMode":0,
        "filters":{
          "Symbol":{
            "i":null,
            "ii":false,
            "k":true,
            "n":false,
            "p":false,
            "v":[
              "TSLA"
            ],
            "x":null,
            "xi":false
          }
        },
        "hah":"true",
        "pinCnt":0,
        "rollupEnabled":false,
        "rtDownstreamMode":"SELECTED_OR_ALL",
        "rtSources":[
          "FEED:orderLadderBuy"
        ],
        "scrollToBottomOnAppend":false,
        "showCommandMenu":true,
        "titlePnl":{
          "title":"orderLadderBuy"
        },
        "upid":"Table2",
        "varTypes":{
          "Price":"Integer",
          "Symbol":"String"
        }
      }
    },
    {
      "portletBuilderId":"amirealtimetable",
      "portletConfig":{
        "amiCols":[
          {
            "fm":"kind",
            "id":"kind",
            "location":0,
            "tl":"Kind",
            "tp":"text",
            "width":100
          },
          {
            "fm":"price",
            "id":"price",
            "location":1,
            "tl":"Price",
            "tp":"price",
            "width":80
          },
          {
            "fm":"qty",
            "id":"qty",
            "location":2,
            "pc":0,
            "tl":"Qty",
            "tp":"numeric",
            "width":80
          },
          {
            "fm":"symbol",
            "id":"symbol",
            "location":3,
            "tl":"Symbol",
            "tp":"text",
            "width":100
          },
          {
            "fm":"timestamp",
            "id":"timestamp",
            "location":4,
            "tl":"Timestamp",
            "tp":"numeric",
            "width":80
          },
          {
            "fm":"type",
            "id":"type",
            "location":5,
            "tl":"type",
            "tp":"text",
            "width":100
          },
          {
            "id":"D",
            "width":100
          },
          {
            "id":"A",
            "width":100
          },
          {
            "id":"!data",
            "width":250
          },
          {
            "id":"M",
            "width":120
          },
          {
            "id":"C",
            "width":120
          },
          {
            "id":"V",
            "width":80
          },
          {
            "id":"W",
            "width":120
          },
          {
            "id":"T",
            "width":100
          },
          {
            "id":"P",
            "width":100
          },
          {
            "id":"E",
            "width":120
          },
          {
            "id":"I",
            "width":100
          }
        ],
        "amiPanelId":"PNL3",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "amiTitle":"client_orders",
        "curtimeUpdateFrequency":1000,
        "editDblClk":true,
        "editMenuTitle":"Edit Row(s)",
        "editMode":0,
        "filters":{
        },
        "hah":"true",
        "pinCnt":0,
        "rollupEnabled":false,
        "rtDownstreamMode":"SELECTED_OR_ALL",
        "rtSources":[
          "FEED:client_orders"
        ],
        "scrollToBottomOnAppend":false,
        "showCommandMenu":true,
        "titlePnl":{
          "title":"client_orders"
        },
        "upid":"Table3",
        "varTypes":{
          "kind":"String",
          "price":"Double",
          "qty":"Integer",
          "symbol":"String",
          "timestamp":"Double",
          "type":"String"
        }
      }
    },
    {
      "portletBuilderId":"tab",
      "portletConfig":{
        "amiPanelId":"Tabs1",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "defaultTab":"tab0",
        "tabs":[
          {
            "child":"Div5",
            "id":"tab0",
            "nf":"\"Ladder\""
          },
          {
            "child":"Html3",
            "id":"tab1",
            "nf":"\"Client Orders\""
          }
        ],
        "upid":"Tabs1"
      }
    },
    {
      "portletBuilderId":"amichartgrid",
      "portletConfig":{
        "amiPanelId":"datamodel1",
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "amiTitle":"FEED:simpleMD",
        "axisBcnts":[
          1
        ],
        "axisConfig":{
          "B_0_0":{
            "amiStyle":{
              "pt":"LAYOUT_DEFAULT"
            },
            "autoMajorValue":true,
            "autoMaxValue":true,
            "autoMinValue":true,
            "autoMinorValue":true,
            "axisId":3,
            "fontStyle":"",
            "format":null,
            "formatType":5,
            "isGroupOrdered":true,
            "orientation":"T",
            "reverse":false,
            "title":"Last Trade Timestamp"
          },
          "L_0_0":{
            "amiStyle":{
              "pt":"LAYOUT_DEFAULT"
            },
            "autoMajorValue":true,
            "autoMaxValue":true,
            "autoMinValue":true,
            "autoMinorValue":true,
            "axisId":2,
            "fontStyle":"",
            "format":null,
            "formatType":5,
            "isGroupOrdered":true,
            "orientation":"R",
            "reverse":true,
            "title":"Price"
          }
        },
        "axisLcnts":[
          1
        ],
        "axisRcnts":[
          0
        ],
        "axisTcnts":[
          0
        ],
        "colsCount":1,
        "dm":[
          {
            "dmadn":"datamodel1",
            "dmtbid":[
              "FEED:simpleMD"
            ]
          }
        ],
        "mdivs":[
          {
            "mdivs":[
              {
                "mdivs":[
                  {
                    "p":-1,
                    "w":1.0
                  }
                ],
                "p":70,
                "w":1.0
              },
              {
                "p":-1,
                "w":1.0
              }
            ],
            "p":-1,
            "w":1.0
          },
          {
            "mdivs":[
              {
                "mdivs":[
                  {
                    "p":-1,
                    "w":1.0
                  }
                ],
                "p":70,
                "w":1.0
              },
              {
                "mdivs":[
                  {
                    "p":-1,
                    "w":1.0
                  }
                ],
                "p":-1,
                "w":1.0
              }
            ],
            "p":70,
            "w":1.0
          }
        ],
        "plotConfig":{
          "0_0":{
            "bgColor":"#ffffff",
            "layers":[
              {
                "amiStyle":{
                  "pt":"LAYOUT_DEFAULT"
                },
                "dmTableName":"FEED:simpleMD",
                "dmadn":"datamodel1",
                "id":0,
                "layers":[
                  {
                    "editorType":"2dLine",
                    "id":4,
                    "lineColor":{
                      "type":"const",
                      "value":"\"#0daa32\""
                    },
                    "lineSize":"1",
                    "mBorderColor":{
                      "type":"const",
                      "value":"\"#007608\""
                    },
                    "mBorderSize":"1",
                    "mColor":{
                      "type":"const",
                      "value":"\"#1b8406\""
                    },
                    "mHeight":"3",
                    "mShape":"\"circle\"",
                    "mWidth":"3",
                    "name":"Symbol",
                    "seriesName":"Layer",
                    "tooltip":"Symbol+\"<BR>\"+\"X: \"+formatNumber(LastTradeTimestamp, \"#.000\", \"\")+\"<BR>Y: \"+formatNumber(Price, \"#.000\", \"\")",
                    "xPos":"LastTradeTimestamp",
                    "yPos":"Price"
                  }
                ],
                "name":"Layer",
                "opac":100,
                "type":"Chart",
                "xAxisId":3,
                "yAxisId":2
              }
            ],
            "plotId":1,
            "selBoxBorderColor":"#404040ef",
            "selBoxFillColor":"#40404007",
            "selColor":"#bacbfb6e"
          }
        },
        "rowsCount":1,
        "titlePnl":{
          "title":"FEED:simpleMD"
        },
        "upid":"datamodel1"
      }
    },
    {
      "portletBuilderId":"amistatictreemap",
      "portletConfig":{
        "amiColors":[
        ],
        "amiGrouping":null,
        "amiHeat":"colorCycle(Price)",
        "amiLabel":"Symbol",
        "amiPanelId":"datamodel2",
        "amiSize":"Price",
        "amiStickyness":5,
        "amiStyle":{
          "pt":"LAYOUT_DEFAULT"
        },
        "amiTip":null,
        "amiTitle":"FEED:simpleMD",
        "dm":[
          {
            "dmadn":"datamodel1",
            "dmtbid":[
              "FEED:simpleMD"
            ]
          }
        ],
        "fontSize":13,
        "ratio":1.0,
        "titlePnl":{
          "title":"FEED:simpleMD"
        },
        "upid":"datamodel2",
        "varTypes":{
          "LastTradeTimestamp":"Long",
          "Price":"Double",
          "Symbol":"String"
        }
      }
    }
  ]
}